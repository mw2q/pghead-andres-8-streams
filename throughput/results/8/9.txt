BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265475713.950831
 ALGERIA                   |   1997 | 454651860.268046
 ALGERIA                   |   1996 | 457003816.322539
 ALGERIA                   |   1995 | 456364708.291368
 ALGERIA                   |   1994 | 452836755.290267
 ALGERIA                   |   1993 | 455823146.417147
 ALGERIA                   |   1992 | 448625502.203271
 ARGENTINA                 |   1998 | 269287842.337984
 ARGENTINA                 |   1997 | 461353737.506772
 ARGENTINA                 |   1996 | 466932078.242104
 ARGENTINA                 |   1995 |  468351333.43509
 ARGENTINA                 |   1994 | 465322481.821806
 ARGENTINA                 |   1993 | 461229977.031274
 ARGENTINA                 |   1992 | 464318023.909921
 BRAZIL                    |   1998 | 274543191.862981
 BRAZIL                    |   1997 |  466955388.80993
 BRAZIL                    |   1996 | 475398071.959632
 BRAZIL                    |   1995 | 464460854.293444
 BRAZIL                    |   1994 |  467519058.87147
 BRAZIL                    |   1993 | 469742636.873594
 BRAZIL                    |   1992 | 472441975.590736
 CANADA                    |   1998 | 267913387.190282
 CANADA                    |   1997 | 468287600.191135
 CANADA                    |   1996 | 474845637.808794
 CANADA                    |   1995 | 465368262.035925
 CANADA                    |   1994 | 472243549.853042
 CANADA                    |   1993 | 469955106.153669
 CANADA                    |   1992 | 461630070.066781
 CHINA                     |   1998 | 274134171.080379
 CHINA                     |   1997 | 460796245.777868
 CHINA                     |   1996 | 462669656.555563
 CHINA                     |   1995 | 461596668.544059
 CHINA                     |   1994 | 463706568.748738
 CHINA                     |   1993 | 457081602.457293
 CHINA                     |   1992 | 464246248.362227
 EGYPT                     |   1998 | 266840202.536697
 EGYPT                     |   1997 | 464370187.678243
 EGYPT                     |   1996 | 460598230.862173
 EGYPT                     |   1995 | 454782525.071462
 EGYPT                     |   1994 | 452488913.139902
 EGYPT                     |   1993 | 461859303.094686
 EGYPT                     |   1992 | 453034536.232491
 ETHIOPIA                  |   1998 | 264826729.628666
 ETHIOPIA                  |   1997 | 447254159.375076
 ETHIOPIA                  |   1996 | 458288870.827503
 ETHIOPIA                  |   1995 | 450185886.532821
 ETHIOPIA                  |   1994 | 457178490.066389
 ETHIOPIA                  |   1993 | 459281130.245098
 ETHIOPIA                  |   1992 | 461858130.224378
 FRANCE                    |   1998 | 270473134.673894
 FRANCE                    |   1997 | 455107003.426543
 FRANCE                    |   1996 | 460948390.546826
 FRANCE                    |   1995 | 451482977.956959
 FRANCE                    |   1994 |  457077887.65773
 FRANCE                    |   1993 | 455387954.706277
 FRANCE                    |   1992 | 457445584.847647
 GERMANY                   |   1998 | 276078923.463715
 GERMANY                   |   1997 | 468569723.655479
 GERMANY                   |   1996 | 473853052.439981
 GERMANY                   |   1995 | 468689371.770978
 GERMANY                   |   1994 | 473800375.580524
 GERMANY                   |   1993 | 481030651.202376
 GERMANY                   |   1992 | 473262812.638029
 INDIA                     |   1998 | 269655548.167496
 INDIA                     |   1997 | 466565954.447401
 INDIA                     |   1996 | 466170356.885778
 INDIA                     |   1995 |  470681447.70083
 INDIA                     |   1994 | 465919004.465836
 INDIA                     |   1993 | 471608711.281759
 INDIA                     |   1992 | 468449676.631422
 INDONESIA                 |   1998 | 270311681.188625
 INDONESIA                 |   1997 | 454370004.433718
 INDONESIA                 |   1996 | 456036426.380307
 INDONESIA                 |   1995 | 454189733.687639
 INDONESIA                 |   1994 | 451461134.573631
 INDONESIA                 |   1993 | 457780636.709149
 INDONESIA                 |   1992 | 462901390.935868
 IRAN                      |   1998 |  275715203.52395
 IRAN                      |   1997 | 468997838.906214
 IRAN                      |   1996 | 472386045.290413
 IRAN                      |   1995 | 468800394.310931
 IRAN                      |   1994 |  465009883.27752
 IRAN                      |   1993 | 466023134.773635
 IRAN                      |   1992 | 469450237.938521
 IRAQ                      |   1998 | 276217466.715996
 IRAQ                      |   1997 | 470410400.975658
 IRAQ                      |   1996 | 486199249.205119
 IRAQ                      |   1995 | 469209858.303767
 IRAQ                      |   1994 | 475177532.244013
 IRAQ                      |   1993 | 477274182.666942
 IRAQ                      |   1992 | 479181194.628052
 JAPAN                     |   1998 | 272836037.797889
 JAPAN                     |   1997 | 467288686.094678
 JAPAN                     |   1996 | 460118301.293164
 JAPAN                     |   1995 | 460930604.672066
 JAPAN                     |   1994 | 462527193.059416
 JAPAN                     |   1993 | 467404996.295474
 JAPAN                     |   1992 | 454369515.361317
 JORDAN                    |   1998 | 267969182.940848
 JORDAN                    |   1997 | 443796220.652301
 JORDAN                    |   1996 |  449350279.63181
 JORDAN                    |   1995 | 443577374.733461
 JORDAN                    |   1994 | 459513654.792347
 JORDAN                    |   1993 | 458557155.770473
 JORDAN                    |   1992 |  448472870.03222
 KENYA                     |   1998 | 272940553.789471
 KENYA                     |   1997 | 466816612.704914
 KENYA                     |   1996 | 466365328.683029
 KENYA                     |   1995 | 466530457.431479
 KENYA                     |   1994 | 470315155.291953
 KENYA                     |   1993 | 474558846.429083
 KENYA                     |   1992 | 473744296.618991
 MOROCCO                   |   1998 |  273618745.46447
 MOROCCO                   |   1997 | 461801899.091955
 MOROCCO                   |   1996 | 470715879.854329
 MOROCCO                   |   1995 | 467811141.797922
 MOROCCO                   |   1994 | 464363966.546719
 MOROCCO                   |   1993 | 467860936.274069
 MOROCCO                   |   1992 | 463320907.512385
 MOZAMBIQUE                |   1998 | 270826854.931512
 MOZAMBIQUE                |   1997 | 452801875.354446
 MOZAMBIQUE                |   1996 | 450514505.756132
 MOZAMBIQUE                |   1995 | 457335257.236241
 MOZAMBIQUE                |   1994 | 461390807.994737
 MOZAMBIQUE                |   1993 | 454618422.944561
 MOZAMBIQUE                |   1992 | 457331581.302959
 PERU                      |   1998 | 276502468.128994
 PERU                      |   1997 | 458577005.602415
 PERU                      |   1996 | 462561870.546666
 PERU                      |   1995 | 466052825.673078
 PERU                      |   1994 | 456112887.431062
 PERU                      |   1993 | 461885908.206477
 PERU                      |   1992 | 469623159.413431
 ROMANIA                   |   1998 | 274261129.949389
 ROMANIA                   |   1997 | 459808669.502051
 ROMANIA                   |   1996 | 464652425.510275
 ROMANIA                   |   1995 | 448343320.759687
 ROMANIA                   |   1994 | 456602292.355341
 ROMANIA                   |   1993 | 462779372.758626
 ROMANIA                   |   1992 | 472542498.078115
 RUSSIA                    |   1998 | 270318418.980648
 RUSSIA                    |   1997 | 460538377.300674
 RUSSIA                    |   1996 | 464778095.151654
 RUSSIA                    |   1995 |  463862618.17054
 RUSSIA                    |   1994 | 451172814.024213
 RUSSIA                    |   1993 |    460328599.632
 RUSSIA                    |   1992 | 471784378.689957
 SAUDI ARABIA              |   1998 | 272708448.296218
 SAUDI ARABIA              |   1997 | 463205059.666055
 SAUDI ARABIA              |   1996 | 460196324.990952
 SAUDI ARABIA              |   1995 | 464733316.786748
 SAUDI ARABIA              |   1994 | 464432741.483911
 SAUDI ARABIA              |   1993 | 457185444.823209
 SAUDI ARABIA              |   1992 | 457585155.180691
 UNITED KINGDOM            |   1998 | 266885192.804817
 UNITED KINGDOM            |   1997 |  463396721.33198
 UNITED KINGDOM            |   1996 | 458535604.156274
 UNITED KINGDOM            |   1995 | 454397507.868993
 UNITED KINGDOM            |   1994 | 464020229.239526
 UNITED KINGDOM            |   1993 | 466050426.299402
 UNITED KINGDOM            |   1992 |  460016476.25405
 UNITED STATES             |   1998 | 271626332.688734
 UNITED STATES             |   1997 | 475744592.219426
 UNITED STATES             |   1996 |  469913779.39225
 UNITED STATES             |   1995 | 470059276.030835
 UNITED STATES             |   1994 | 473476339.437572
 UNITED STATES             |   1993 | 463724093.644679
 UNITED STATES             |   1992 | 470862138.574315
 VIETNAM                   |   1998 | 271782156.492264
 VIETNAM                   |   1997 | 463673610.021599
 VIETNAM                   |   1996 | 471536471.242169
 VIETNAM                   |   1995 | 461062022.437998
 VIETNAM                   |   1994 | 466046547.212012
 VIETNAM                   |   1993 | 470150202.091764
 VIETNAM                   |   1992 |  467766264.00139
(175 rows)

COMMIT;
COMMIT
