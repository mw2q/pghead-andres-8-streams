BEGIN;
BEGIN
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 315
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice | sum 
--------------------+-----------+------------+-------------+--------------+-----
 Customer#001287812 |   1287812 |   42290181 | 1997-11-26  |       558289 | 318
 Customer#001172513 |   1172513 |   36667107 | 1997-06-06  |       550142 | 322
 Customer#000571654 |    571654 |   21213895 | 1992-01-03  |       549380 | 327
 Customer#000667882 |    667882 |    2199712 | 1996-09-30  |       542154 | 327
 Customer#001471966 |   1471966 |    1263015 | 1997-02-02  |       540477 | 320
 Customer#001101754 |   1101754 |   46794464 | 1992-04-28  |       532624 | 320
 Customer#000591466 |    591466 |   55799200 | 1996-02-11  |       524209 | 327
 Customer#001196317 |   1196317 |   34509573 | 1995-10-15  |       522897 | 318
 Customer#001308376 |   1308376 |   28077922 | 1996-10-27  |       518712 | 319
 Customer#000008782 |      8782 |   29294434 | 1993-01-05  |       518141 | 322
 Customer#001232356 |   1232356 |   52340710 | 1993-01-01  |       512293 | 320
 Customer#001247930 |   1247930 |   59138305 | 1993-10-31  |       509373 | 321
 Customer#000998485 |    998485 |   51532000 | 1992-10-27  |       506997 | 319
 Customer#001179178 |   1179178 |    2869152 | 1996-06-20  |       505143 | 317
 Customer#000942725 |    942725 |   48881602 | 1993-09-19  |       504198 | 327
 Customer#000212452 |    212452 |   23245603 | 1994-11-22  |       504071 | 321
 Customer#000266747 |    266747 |   41274690 | 1992-08-10  |       503260 | 317
 Customer#000896006 |    896006 |   24923202 | 1993-10-04  |       503198 | 316
 Customer#000166589 |    166589 |   46685344 | 1993-12-14  |       496075 | 327
 Customer#000324296 |    324296 |   26465922 | 1996-11-04  |       493280 | 331
 Customer#001081807 |   1081807 |    8075589 | 1996-08-23  |       492480 | 316
 Customer#000389473 |    389473 |   21135524 | 1992-11-22  |       487246 | 320
 Customer#001151815 |   1151815 |   55722822 | 1995-08-24  |       485654 | 316
 Customer#000372146 |    372146 |   48300454 | 1992-11-30  |       484963 | 318
 Customer#000225562 |    225562 |   39492870 | 1995-08-12  |       484783 | 317
 Customer#000109402 |    109402 |   10612710 | 1995-02-05  |       484660 | 319
 Customer#000604861 |    604861 |   45897379 | 1994-05-30  |       481442 | 318
 Customer#000347839 |    347839 |   53623108 | 1995-05-07  |       481252 | 316
 Customer#001350514 |   1350514 |   43245189 | 1994-11-29  |       480989 | 320
 Customer#000456290 |    456290 |   58000519 | 1996-01-17  |       480281 | 325
 Customer#001076014 |   1076014 |   58919845 | 1995-07-21  |       478889 | 316
 Customer#001379158 |   1379158 |   49474597 | 1992-03-06  |       478863 | 319
 Customer#001115629 |   1115629 |   13165024 | 1992-06-29  |       477665 | 318
 Customer#000598354 |    598354 |   56497062 | 1998-04-28  |       476883 | 320
 Customer#001424164 |   1424164 |   48395044 | 1994-06-03  |       476440 | 316
 Customer#000008846 |      8846 |   39702437 | 1995-11-23  |       475436 | 321
 Customer#001075219 |   1075219 |   44143908 | 1992-02-24  |       472297 | 325
 Customer#000156190 |    156190 |    3767271 | 1996-08-07  |       471132 | 318
 Customer#000087946 |     87946 |   10805828 | 1997-07-29  |       469151 | 316
 Customer#001209827 |   1209827 |   12314084 | 1994-05-16  |       467105 | 325
 Customer#001268641 |   1268641 |    4702759 | 1994-11-07  |       466780 | 320
 Customer#000366184 |    366184 |    4806726 | 1995-01-17  |       466288 | 328
 Customer#000317285 |    317285 |   44178691 | 1998-01-24  |       459635 | 316
 Customer#000773062 |    773062 |   38914978 | 1996-05-28  |       458850 | 324
 Customer#001380298 |   1380298 |   13837220 | 1994-09-07  |       454999 | 316
 Customer#000952849 |    952849 |   40944001 | 1993-12-15  |       454782 | 319
 Customer#000109817 |    109817 |   10408580 | 1994-09-03  |       454421 | 320
 Customer#000064357 |     64357 |    7235014 | 1998-03-09  |       454343 | 323
 Customer#001140475 |   1140475 |   29122912 | 1996-05-08  |       453750 | 323
 Customer#000523666 |    523666 |   32393895 | 1993-08-09  |       453417 | 316
 Customer#001281199 |   1281199 |    4722021 | 1994-04-07  |       452130 | 323
 Customer#000353261 |    353261 |   22017989 | 1996-06-17  |       452128 | 318
 Customer#000631198 |    631198 |   12378086 | 1995-03-13  |       447447 | 320
 Customer#000665395 |    665395 |    7810823 | 1998-01-05  |       447000 | 324
 Customer#000181624 |    181624 |   17457767 | 1993-06-05  |       445836 | 316
 Customer#001481954 |   1481954 |   43609317 | 1996-02-17  |       444566 | 325
 Customer#001163407 |   1163407 |   11141606 | 1997-09-28  |       442694 | 325
 Customer#000981457 |    981457 |   20971013 | 1997-08-12  |       442063 | 322
 Customer#000500566 |    500566 |   35383045 | 1997-12-11  |       441239 | 317
 Customer#000853729 |    853729 |   15071267 | 1994-10-22  |       440971 | 317
 Customer#001446161 |   1446161 |    3043270 | 1997-02-12  |       440815 | 317
 Customer#001242919 |   1242919 |   49847329 | 1995-09-20  |       440256 | 319
 Customer#000167087 |    167087 |   17366275 | 1998-01-14  |       437804 | 316
 Customer#001180559 |   1180559 |   19217698 | 1993-03-26  |       437604 | 316
 Customer#000644810 |    644810 |   28184576 | 1994-01-29  |       437397 | 324
 Customer#001207069 |   1207069 |   34201984 | 1997-06-18  |       433879 | 322
 Customer#000773104 |    773104 |   33615872 | 1997-09-28  |       426834 | 317
 Customer#000075070 |     75070 |   43997089 | 1994-08-07  |       424267 | 317
 Customer#000144853 |    144853 |   11599171 | 1998-03-22  |       423979 | 316
 Customer#001227100 |   1227100 |   35542498 | 1993-10-12  |       417981 | 325
 Customer#001185599 |   1185599 |   54188961 | 1995-06-17  |       407873 | 317
 Customer#001199881 |   1199881 |    1544643 | 1997-09-20  |       406906 | 320
 Customer#001188142 |   1188142 |   42997059 | 1997-03-15  |       404133 | 320
 Customer#001288183 |   1288183 |   48943904 | 1996-07-22  |       398082 | 325
 Customer#000114613 |    114613 |   59930883 | 1997-05-17  |       394336 | 319
(75 rows)

COMMIT;
COMMIT
